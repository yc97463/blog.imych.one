<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>è¸©å‘ç´€éŒ„ï¼šåœ¨ç„¡ Git CLI çš„ Synology DSM ä¸Šå¯¦ä½œ Git Private Repository è‡ªå‹•æ›´æ–° | YC Photography</title><meta name=keywords content="Synology,Git,Docker,GitHub"><meta name=description content="æœ‰äº›äººæƒ³åœ¨è‡ªå·±çš„ Synology NAS ä¸Šæ¶ç¶²ç«™ï¼Œä¸¦ä¸”è®“ç¨‹å¼ç¢¼èƒ½è‡ªå‹•ç‰ˆæœ¬æ›´æ–°ã€‚å¦‚æœåœ¨ç´” Linux ç’°å¢ƒè£¡æ“ä½œï¼Œé€™æ¨£çš„éœ€æ±‚ä¸ç®—å¤ªéº»ç…©ï¼Œé€šå¸¸å¯ä»¥æ­é… crontab + git ä¾†è‡ªå‹•æ›´æ–°ç¨‹å¼ç¢¼ï¼Œå°±ç®—æ˜¯ Private Repository ä¹Ÿä¸æ˜¯å¤ªå¤§çš„å•é¡Œã€‚
ä¸éå¦‚æœæƒ³è¦åœ¨ Synology DSM ï¼ˆä»¥ä¸‹ç¨± DSMï¼‰ä¸Šå¯¦ä½œï¼Œç”±æ–¼ DSM å’Œçµ‚ç«¯é è¨­æ²’æœ‰å…§å»º Git CLIï¼Œé™¤äº†å¥—ä»¶ä¸­å¿ƒä¸æ”¯æ´ï¼Œè‡ªè¡Œå®‰è£ä¹Ÿéœ€è¦æ“”å¿ƒæ±¡æŸ“ç’°å¢ƒæˆ–è¢«è¦†å¯«ã€‚é™¤äº†ç›´æ¥æŠŠ code æ‰‹å‹•æ”¾åˆ°å°ˆæ¡ˆç›®éŒ„è£¡ï¼Œæˆ‘å€‘è¦ä¾†ç”¨ä¸€äº›åœŸç‚®çš„æ–¹å¼ç¹éé€™äº›é™åˆ¶ã€‚
é€™ç¯‡å°‡ç¤ºç¯„ï¼š

ä½¿ç”¨ GitHub Deploy Key é€²è¡Œæ¬Šé™é©—è­‰
ä½¿ç”¨ Docker container åŸ·è¡Œ git pull
è‡ªå‹•æ›´æ–° repo è‡³æŒ‡å®šè³‡æ–™å¤¾
å¯æ•´åˆ DSM ä»»å‹™æ’ç¨‹å™¨å®šæ™‚åŸ·è¡Œ


ğŸ§± å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™å¤¾çµæ§‹
åœ¨ Synology ä¸Šå»ºç«‹ä»¥ä¸‹ç›®éŒ„çµæ§‹ï¼Œå°‡æœƒç”¨åˆ°çš„ SSH è¨­å®šæª”ã€è…³æœ¬ç­‰éƒ½æ”¾åœ¨é€™å€‹è³‡æ–™å¤¾è£¡ã€‚
è«‹æ­é… SSH é€£ç·šä¾†æ“ä½œåœ¨æ ¹ç›®éŒ„å»ºç«‹è³‡æ–™å¤¾ã€‚

å¦‚æœ SSH é€£ç·šçš„åŠŸèƒ½é‚„æ²’å•Ÿç”¨ï¼Œè«‹å…ˆåˆ° Synology çš„æ§åˆ¶å° â†’ å®‰å…¨æ€§ â†’ é ç«¯å­˜å– â†’ å•Ÿç”¨é ç«¯å­˜å–ã€‚


volume1 æ˜¯æˆ‘é€™å° Synology ä¸Šçš„æ ¹ç›®éŒ„ï¼Œå¦‚æœä½ æœ‰å…¶ä»–é¸æ“‡ï¼Œä½ å¯ä»¥æ”¹æˆå…¶ä»–ç›®éŒ„ï¼Œä¾‹å¦‚ /volume2/ æˆ– /volume3/ã€‚"><meta name=author content="map[name:æ²¹æˆ]"><link rel=canonical href=https://blog.imych.one/synology-git-pull-with-docker-and-deploy-key/><link crossorigin=anonymous href=/assets/css/stylesheet.5992f176555aa017ee8325dc1c15512693d0a46357ce3faf61d6456b618acca3.css integrity="sha256-WZLxdlVaoBfugyXcHBVRJpPQpGNXzj+vYdZFa2GKzKM=" rel="preload stylesheet" as=style><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Noto+Sans+TC:wght@100..900&family=Space+Grotesk:wght@300..700&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&&display=swap" rel=stylesheet><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://imych.one/assets/youu.png><link rel=icon type=image/png sizes=16x16 href=https://imych.one/assets/youu.png><link rel=icon type=image/png sizes=32x32 href=https://imych.one/assets/youu.png><link rel=apple-touch-icon href=https://imych.one/assets/youu.png><link rel=mask-icon href=https://imych.one/assets/youu.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://blog.imych.one/synology-git-pull-with-docker-and-deploy-key/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://blog.imych.one/synology-git-pull-with-docker-and-deploy-key/"><meta property="og:site_name" content="YC Photography"><meta property="og:title" content="è¸©å‘ç´€éŒ„ï¼šåœ¨ç„¡ Git CLI çš„ Synology DSM ä¸Šå¯¦ä½œ Git Private Repository è‡ªå‹•æ›´æ–°"><meta property="og:description" content="æœ‰äº›äººæƒ³åœ¨è‡ªå·±çš„ Synology NAS ä¸Šæ¶ç¶²ç«™ï¼Œä¸¦ä¸”è®“ç¨‹å¼ç¢¼èƒ½è‡ªå‹•ç‰ˆæœ¬æ›´æ–°ã€‚å¦‚æœåœ¨ç´” Linux ç’°å¢ƒè£¡æ“ä½œï¼Œé€™æ¨£çš„éœ€æ±‚ä¸ç®—å¤ªéº»ç…©ï¼Œé€šå¸¸å¯ä»¥æ­é… crontab + git ä¾†è‡ªå‹•æ›´æ–°ç¨‹å¼ç¢¼ï¼Œå°±ç®—æ˜¯ Private Repository ä¹Ÿä¸æ˜¯å¤ªå¤§çš„å•é¡Œã€‚
ä¸éå¦‚æœæƒ³è¦åœ¨ Synology DSM ï¼ˆä»¥ä¸‹ç¨± DSMï¼‰ä¸Šå¯¦ä½œï¼Œç”±æ–¼ DSM å’Œçµ‚ç«¯é è¨­æ²’æœ‰å…§å»º Git CLIï¼Œé™¤äº†å¥—ä»¶ä¸­å¿ƒä¸æ”¯æ´ï¼Œè‡ªè¡Œå®‰è£ä¹Ÿéœ€è¦æ“”å¿ƒæ±¡æŸ“ç’°å¢ƒæˆ–è¢«è¦†å¯«ã€‚é™¤äº†ç›´æ¥æŠŠ code æ‰‹å‹•æ”¾åˆ°å°ˆæ¡ˆç›®éŒ„è£¡ï¼Œæˆ‘å€‘è¦ä¾†ç”¨ä¸€äº›åœŸç‚®çš„æ–¹å¼ç¹éé€™äº›é™åˆ¶ã€‚
é€™ç¯‡å°‡ç¤ºç¯„ï¼š
ä½¿ç”¨ GitHub Deploy Key é€²è¡Œæ¬Šé™é©—è­‰ ä½¿ç”¨ Docker container åŸ·è¡Œ git pull è‡ªå‹•æ›´æ–° repo è‡³æŒ‡å®šè³‡æ–™å¤¾ å¯æ•´åˆ DSM ä»»å‹™æ’ç¨‹å™¨å®šæ™‚åŸ·è¡Œ ğŸ§± å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™å¤¾çµæ§‹ åœ¨ Synology ä¸Šå»ºç«‹ä»¥ä¸‹ç›®éŒ„çµæ§‹ï¼Œå°‡æœƒç”¨åˆ°çš„ SSH è¨­å®šæª”ã€è…³æœ¬ç­‰éƒ½æ”¾åœ¨é€™å€‹è³‡æ–™å¤¾è£¡ã€‚
è«‹æ­é… SSH é€£ç·šä¾†æ“ä½œåœ¨æ ¹ç›®éŒ„å»ºç«‹è³‡æ–™å¤¾ã€‚
å¦‚æœ SSH é€£ç·šçš„åŠŸèƒ½é‚„æ²’å•Ÿç”¨ï¼Œè«‹å…ˆåˆ° Synology çš„æ§åˆ¶å° â†’ å®‰å…¨æ€§ â†’ é ç«¯å­˜å– â†’ å•Ÿç”¨é ç«¯å­˜å–ã€‚
volume1 æ˜¯æˆ‘é€™å° Synology ä¸Šçš„æ ¹ç›®éŒ„ï¼Œå¦‚æœä½ æœ‰å…¶ä»–é¸æ“‡ï¼Œä½ å¯ä»¥æ”¹æˆå…¶ä»–ç›®éŒ„ï¼Œä¾‹å¦‚ /volume2/ æˆ– /volume3/ã€‚"><meta property="og:locale" content="zh-TW"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-07-16T00:00:00+08:00"><meta property="article:modified_time" content="2025-07-16T00:00:00+08:00"><meta property="article:tag" content="Synology"><meta property="article:tag" content="Git"><meta property="article:tag" content="Docker"><meta property="article:tag" content="GitHub"><meta property="og:image" content="https://blog.imych.one/synology-git-pull-with-docker-and-deploy-key/SCR-20250716-fkyr.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.imych.one/synology-git-pull-with-docker-and-deploy-key/SCR-20250716-fkyr.png"><meta name=twitter:title content="è¸©å‘ç´€éŒ„ï¼šåœ¨ç„¡ Git CLI çš„ Synology DSM ä¸Šå¯¦ä½œ Git Private Repository è‡ªå‹•æ›´æ–°"><meta name=twitter:description content="æœ‰äº›äººæƒ³åœ¨è‡ªå·±çš„ Synology NAS ä¸Šæ¶ç¶²ç«™ï¼Œä¸¦ä¸”è®“ç¨‹å¼ç¢¼èƒ½è‡ªå‹•ç‰ˆæœ¬æ›´æ–°ã€‚å¦‚æœåœ¨ç´” Linux ç’°å¢ƒè£¡æ“ä½œï¼Œé€™æ¨£çš„éœ€æ±‚ä¸ç®—å¤ªéº»ç…©ï¼Œé€šå¸¸å¯ä»¥æ­é… crontab + git ä¾†è‡ªå‹•æ›´æ–°ç¨‹å¼ç¢¼ï¼Œå°±ç®—æ˜¯ Private Repository ä¹Ÿä¸æ˜¯å¤ªå¤§çš„å•é¡Œã€‚
ä¸éå¦‚æœæƒ³è¦åœ¨ Synology DSM ï¼ˆä»¥ä¸‹ç¨± DSMï¼‰ä¸Šå¯¦ä½œï¼Œç”±æ–¼ DSM å’Œçµ‚ç«¯é è¨­æ²’æœ‰å…§å»º Git CLIï¼Œé™¤äº†å¥—ä»¶ä¸­å¿ƒä¸æ”¯æ´ï¼Œè‡ªè¡Œå®‰è£ä¹Ÿéœ€è¦æ“”å¿ƒæ±¡æŸ“ç’°å¢ƒæˆ–è¢«è¦†å¯«ã€‚é™¤äº†ç›´æ¥æŠŠ code æ‰‹å‹•æ”¾åˆ°å°ˆæ¡ˆç›®éŒ„è£¡ï¼Œæˆ‘å€‘è¦ä¾†ç”¨ä¸€äº›åœŸç‚®çš„æ–¹å¼ç¹éé€™äº›é™åˆ¶ã€‚
é€™ç¯‡å°‡ç¤ºç¯„ï¼š

ä½¿ç”¨ GitHub Deploy Key é€²è¡Œæ¬Šé™é©—è­‰
ä½¿ç”¨ Docker container åŸ·è¡Œ git pull
è‡ªå‹•æ›´æ–° repo è‡³æŒ‡å®šè³‡æ–™å¤¾
å¯æ•´åˆ DSM ä»»å‹™æ’ç¨‹å™¨å®šæ™‚åŸ·è¡Œ


ğŸ§± å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™å¤¾çµæ§‹
åœ¨ Synology ä¸Šå»ºç«‹ä»¥ä¸‹ç›®éŒ„çµæ§‹ï¼Œå°‡æœƒç”¨åˆ°çš„ SSH è¨­å®šæª”ã€è…³æœ¬ç­‰éƒ½æ”¾åœ¨é€™å€‹è³‡æ–™å¤¾è£¡ã€‚
è«‹æ­é… SSH é€£ç·šä¾†æ“ä½œåœ¨æ ¹ç›®éŒ„å»ºç«‹è³‡æ–™å¤¾ã€‚

å¦‚æœ SSH é€£ç·šçš„åŠŸèƒ½é‚„æ²’å•Ÿç”¨ï¼Œè«‹å…ˆåˆ° Synology çš„æ§åˆ¶å° â†’ å®‰å…¨æ€§ â†’ é ç«¯å­˜å– â†’ å•Ÿç”¨é ç«¯å­˜å–ã€‚


volume1 æ˜¯æˆ‘é€™å° Synology ä¸Šçš„æ ¹ç›®éŒ„ï¼Œå¦‚æœä½ æœ‰å…¶ä»–é¸æ“‡ï¼Œä½ å¯ä»¥æ”¹æˆå…¶ä»–ç›®éŒ„ï¼Œä¾‹å¦‚ /volume2/ æˆ– /volume3/ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.imych.one/post/"},{"@type":"ListItem","position":2,"name":"è¸©å‘ç´€éŒ„ï¼šåœ¨ç„¡ Git CLI çš„ Synology DSM ä¸Šå¯¦ä½œ Git Private Repository è‡ªå‹•æ›´æ–°","item":"https://blog.imych.one/synology-git-pull-with-docker-and-deploy-key/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"è¸©å‘ç´€éŒ„ï¼šåœ¨ç„¡ Git CLI çš„ Synology DSM ä¸Šå¯¦ä½œ Git Private Repository è‡ªå‹•æ›´æ–°","name":"è¸©å‘ç´€éŒ„ï¼šåœ¨ç„¡ Git CLI çš„ Synology DSM ä¸Šå¯¦ä½œ Git Private Repository è‡ªå‹•æ›´æ–°","description":"æœ‰äº›äººæƒ³åœ¨è‡ªå·±çš„ Synology NAS ä¸Šæ¶ç¶²ç«™ï¼Œä¸¦ä¸”è®“ç¨‹å¼ç¢¼èƒ½è‡ªå‹•ç‰ˆæœ¬æ›´æ–°ã€‚å¦‚æœåœ¨ç´” Linux ç’°å¢ƒè£¡æ“ä½œï¼Œé€™æ¨£çš„éœ€æ±‚ä¸ç®—å¤ªéº»ç…©ï¼Œé€šå¸¸å¯ä»¥æ­é… crontab + git ä¾†è‡ªå‹•æ›´æ–°ç¨‹å¼ç¢¼ï¼Œå°±ç®—æ˜¯ Private Repository ä¹Ÿä¸æ˜¯å¤ªå¤§çš„å•é¡Œã€‚\nä¸éå¦‚æœæƒ³è¦åœ¨ Synology DSM ï¼ˆä»¥ä¸‹ç¨± DSMï¼‰ä¸Šå¯¦ä½œï¼Œç”±æ–¼ DSM å’Œçµ‚ç«¯é è¨­æ²’æœ‰å…§å»º Git CLIï¼Œé™¤äº†å¥—ä»¶ä¸­å¿ƒä¸æ”¯æ´ï¼Œè‡ªè¡Œå®‰è£ä¹Ÿéœ€è¦æ“”å¿ƒæ±¡æŸ“ç’°å¢ƒæˆ–è¢«è¦†å¯«ã€‚é™¤äº†ç›´æ¥æŠŠ code æ‰‹å‹•æ”¾åˆ°å°ˆæ¡ˆç›®éŒ„è£¡ï¼Œæˆ‘å€‘è¦ä¾†ç”¨ä¸€äº›åœŸç‚®çš„æ–¹å¼ç¹éé€™äº›é™åˆ¶ã€‚\né€™ç¯‡å°‡ç¤ºç¯„ï¼š\nä½¿ç”¨ GitHub Deploy Key é€²è¡Œæ¬Šé™é©—è­‰ ä½¿ç”¨ Docker container åŸ·è¡Œ git pull è‡ªå‹•æ›´æ–° repo è‡³æŒ‡å®šè³‡æ–™å¤¾ å¯æ•´åˆ DSM ä»»å‹™æ’ç¨‹å™¨å®šæ™‚åŸ·è¡Œ ğŸ§± å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™å¤¾çµæ§‹ åœ¨ Synology ä¸Šå»ºç«‹ä»¥ä¸‹ç›®éŒ„çµæ§‹ï¼Œå°‡æœƒç”¨åˆ°çš„ SSH è¨­å®šæª”ã€è…³æœ¬ç­‰éƒ½æ”¾åœ¨é€™å€‹è³‡æ–™å¤¾è£¡ã€‚\nè«‹æ­é… SSH é€£ç·šä¾†æ“ä½œåœ¨æ ¹ç›®éŒ„å»ºç«‹è³‡æ–™å¤¾ã€‚\nå¦‚æœ SSH é€£ç·šçš„åŠŸèƒ½é‚„æ²’å•Ÿç”¨ï¼Œè«‹å…ˆåˆ° Synology çš„æ§åˆ¶å° â†’ å®‰å…¨æ€§ â†’ é ç«¯å­˜å– â†’ å•Ÿç”¨é ç«¯å­˜å–ã€‚\nvolume1 æ˜¯æˆ‘é€™å° Synology ä¸Šçš„æ ¹ç›®éŒ„ï¼Œå¦‚æœä½ æœ‰å…¶ä»–é¸æ“‡ï¼Œä½ å¯ä»¥æ”¹æˆå…¶ä»–ç›®éŒ„ï¼Œä¾‹å¦‚ /volume2/ æˆ– /volume3/ã€‚\n","keywords":["Synology","Git","Docker","GitHub"],"articleBody":"æœ‰äº›äººæƒ³åœ¨è‡ªå·±çš„ Synology NAS ä¸Šæ¶ç¶²ç«™ï¼Œä¸¦ä¸”è®“ç¨‹å¼ç¢¼èƒ½è‡ªå‹•ç‰ˆæœ¬æ›´æ–°ã€‚å¦‚æœåœ¨ç´” Linux ç’°å¢ƒè£¡æ“ä½œï¼Œé€™æ¨£çš„éœ€æ±‚ä¸ç®—å¤ªéº»ç…©ï¼Œé€šå¸¸å¯ä»¥æ­é… crontab + git ä¾†è‡ªå‹•æ›´æ–°ç¨‹å¼ç¢¼ï¼Œå°±ç®—æ˜¯ Private Repository ä¹Ÿä¸æ˜¯å¤ªå¤§çš„å•é¡Œã€‚\nä¸éå¦‚æœæƒ³è¦åœ¨ Synology DSM ï¼ˆä»¥ä¸‹ç¨± DSMï¼‰ä¸Šå¯¦ä½œï¼Œç”±æ–¼ DSM å’Œçµ‚ç«¯é è¨­æ²’æœ‰å…§å»º Git CLIï¼Œé™¤äº†å¥—ä»¶ä¸­å¿ƒä¸æ”¯æ´ï¼Œè‡ªè¡Œå®‰è£ä¹Ÿéœ€è¦æ“”å¿ƒæ±¡æŸ“ç’°å¢ƒæˆ–è¢«è¦†å¯«ã€‚é™¤äº†ç›´æ¥æŠŠ code æ‰‹å‹•æ”¾åˆ°å°ˆæ¡ˆç›®éŒ„è£¡ï¼Œæˆ‘å€‘è¦ä¾†ç”¨ä¸€äº›åœŸç‚®çš„æ–¹å¼ç¹éé€™äº›é™åˆ¶ã€‚\né€™ç¯‡å°‡ç¤ºç¯„ï¼š\nä½¿ç”¨ GitHub Deploy Key é€²è¡Œæ¬Šé™é©—è­‰ ä½¿ç”¨ Docker container åŸ·è¡Œ git pull è‡ªå‹•æ›´æ–° repo è‡³æŒ‡å®šè³‡æ–™å¤¾ å¯æ•´åˆ DSM ä»»å‹™æ’ç¨‹å™¨å®šæ™‚åŸ·è¡Œ ğŸ§± å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™å¤¾çµæ§‹ åœ¨ Synology ä¸Šå»ºç«‹ä»¥ä¸‹ç›®éŒ„çµæ§‹ï¼Œå°‡æœƒç”¨åˆ°çš„ SSH è¨­å®šæª”ã€è…³æœ¬ç­‰éƒ½æ”¾åœ¨é€™å€‹è³‡æ–™å¤¾è£¡ã€‚\nè«‹æ­é… SSH é€£ç·šä¾†æ“ä½œåœ¨æ ¹ç›®éŒ„å»ºç«‹è³‡æ–™å¤¾ã€‚\nå¦‚æœ SSH é€£ç·šçš„åŠŸèƒ½é‚„æ²’å•Ÿç”¨ï¼Œè«‹å…ˆåˆ° Synology çš„æ§åˆ¶å° â†’ å®‰å…¨æ€§ â†’ é ç«¯å­˜å– â†’ å•Ÿç”¨é ç«¯å­˜å–ã€‚\nvolume1 æ˜¯æˆ‘é€™å° Synology ä¸Šçš„æ ¹ç›®éŒ„ï¼Œå¦‚æœä½ æœ‰å…¶ä»–é¸æ“‡ï¼Œä½ å¯ä»¥æ”¹æˆå…¶ä»–ç›®éŒ„ï¼Œä¾‹å¦‚ /volume2/ æˆ– /volume3/ã€‚\n/volume1/ # ä½ çš„ NAS æ ¹ç›®éŒ„ï¼Œæ­¤è™•ä»¥ volume1 ç‚ºä¾‹ â””â”€â”€ / # ä½ æ”¾å°ˆæ¡ˆ code è³‡æ–™å¤¾çš„åç¨± â””â”€â”€ git_pull_env/ # Git è‡ªå‹•åŒ–åŸ·è¡Œç’°å¢ƒ â”œâ”€â”€ .ssh/ # å­˜æ”¾ Deploy Key èˆ‡ ssh config â”œâ”€â”€ git-pull-in-docker.sh # ç”¨ Docker åŸ·è¡Œ git pull çš„è…³æœ¬ â””â”€â”€ known_hosts # é è¨­å¡«å…¥ github.com host key ğŸ” æ­¥é©Ÿ 1ï¼šç”¢ç”Ÿ SSH Deploy Key æˆ‘å€‘æ¡ç”¨ SSH Deploy Key çš„æ–¹å¼ä¾†éƒ¨ç½²ï¼Œç›¸è¼ƒæ–¼ä½¿ç”¨ URL æ­é… access tokenï¼Œé€™ç¨®æ–¹å¼æ›´ç‚ºå®‰å…¨ï¼Œèƒ½æœ‰æ•ˆé¿å… token åœ¨é€£ç·šéç¨‹ä¸­è¢«ç«Šè½æˆ–ç›œç”¨ã€‚\né€£ç·šæ–¹å¼ å„ªé» ç¼ºé» é©ç”¨æƒ…å¢ƒ HTTPS ï¼ˆæ­é… Personal Access Tokenï¼‰ æ˜“æ–¼è¨­å®šï¼šåªéœ€åœ¨ URL ä¸­åµŒå…¥ access token å³å¯ã€‚ å®‰å…¨æ€§è¼ƒä½ï¼štoken åœ¨é€£ç·šéç¨‹ä¸­å¯èƒ½è¢«æƒ¡æ„ç¨‹å¼ç¢¼æˆ–ç¶²è·¯ç›£è½ç«Šå–ï¼Œå­˜åœ¨å¤–æ´©é¢¨éšªã€‚ å€‹äººå°ˆæ¡ˆæˆ–éæ©Ÿå¯†æ€§çš„éƒ¨ç½²ç’°å¢ƒã€‚ SSH ï¼ˆæ­é… Deploy Keyï¼‰ å®‰å…¨æ€§æ›´é«˜ï¼šæ¡ç”¨åŠ å¯†é€šè¨Šå”å®šï¼Œé€£ç·šéç¨‹ä¸­ä¸æœƒå‚³è¼¸ä»»ä½•æ†‘è­‰ï¼Œæœ‰æ•ˆé¿å… token è¢«ç«Šè½æˆ–ç›œç”¨ã€‚ è¨­å®šæ­¥é©Ÿè¼ƒç‚ºç¹ç‘£ï¼šéœ€è¦ç”¢ç”Ÿ SSH é‡‘é‘°å°ä¸¦åœ¨ GitHub å°ˆæ¡ˆä¸­æ–°å¢ Deploy Keyã€‚ æ­£å¼éƒ¨ç½²ç’°å¢ƒã€ä¼ºæœå™¨æˆ–éœ€è¦åš´è¬¹å®‰å…¨æ€§çš„è‡ªå‹•åŒ–éƒ¨ç½²æµç¨‹ã€‚ ä½¿ç”¨ SSH é€£ç·šè‡³ä½ çš„ NASï¼Œåœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ã€‚\nmkdir -p /volume1//git_pull_env/.ssh ssh-keygen -t ed25519 -f /volume1//git_pull_env/.ssh/id_ed25519 -C \"@\" chmod 600 /volume1//git_pull_env/.ssh/id_ed25519 ç¬¬äºŒæ¢æŒ‡ä»¤æœ«ç«¯çš„ æ˜¯ç‚ºäº†æ–¹ä¾¿è¾¨è­˜ï¼Œå¯ä»¥æ”¹æˆå…¶ä»–åç¨±ï¼› å‰‡æ˜¯ä½ çš„ NAS ä¸»æ©Ÿåç¨±ï¼Œä¸€æ¨£å¯ä»¥æ”¹æˆå…¶ä»–åç¨±ï¼Œä¾‹å¦‚ deploy@yc_nasã€‚\nğŸ“‹ æ­¥é©Ÿ 2ï¼šè¨­å®š SSH config SSH config çš„è¨­å®šï¼ŒæŒ‡å®šä½¿ç”¨æˆ‘å€‘å‰›å‰›ç”¢ç”Ÿçš„ Deploy Keyï¼Œä¸»è¦æ˜¯ç‚ºäº†è®“ GitHub èªå¾—é€™æ”¯æœ‰æ¬Šé™çš„èº«ä»½ï¼Œé€²è€Œå­˜å–å°ˆæ¡ˆã€‚\ncat \u003e /volume1//git_pull_env/.ssh/config \u003c\u003c'EOF' Host github.com HostName github.com User git IdentityFile /root/.ssh/id_ed25519 IdentitiesOnly yes EOF chmod 600 /volume1//git_pull_env/.ssh/config ğŸ›¡ï¸ æ­¥é©Ÿ 3ï¼šæ‰‹å‹•å¡«å…¥ GitHub known_hosts ç•¶æˆ‘å€‘ç”¨ SSH å»é€£ GitHub æ‹‰åŸå§‹ç¢¼æ™‚ï¼Œç³»çµ±æœƒå…ˆæª¢æŸ¥ä¸»æ©ŸæŒ‡ç´‹ï¼ˆhost fingerprintï¼‰ä¾†ç¢ºä¿ã€Œä½ é€£çš„çœŸçš„æ˜¯ GitHubï¼Œè€Œä¸æ˜¯æŸå€‹å‡å†’çš„ä¸­é–“äººã€ã€‚é€™å…¶å¯¦æ˜¯é¿å… ä¸­é–“äººæ”»æ“Šï¼ˆMITMï¼‰ çš„ä¸€ç¨®æ©Ÿåˆ¶ã€‚\nå¹³å¸¸å¦‚æœæœ‰å®‰è£ ssh-keyscan æŒ‡ä»¤çš„è©±ï¼Œæˆ‘å€‘å¯ä»¥ç”¨å®ƒè‡ªå‹•æŠŠ GitHub çš„ä¸»æ©Ÿé‡‘é‘°åŠ é€² known_hostsã€‚ä½†åœ¨ DSM ä¸Šååæ²’æœ‰é€™å€‹å·¥å…·ï¼Œå› æ­¤æˆ‘å€‘å¾—ã€Œæ‰‹å‹•ã€æŠŠ GitHub çš„ä¸»æ©ŸæŒ‡ç´‹åŠ é€²å»ã€‚\nå¯ä»¥åˆ° GitHub å®˜æ–¹æŸ¥è©¢ä»–å€‘ç›®å‰çš„ SSH ä¸»æ©ŸæŒ‡ç´‹ ï¼Œç„¶å¾Œæ‰‹å‹•æŠŠå…§å®¹å¯«é€² ~/.ssh/known_hosts è£¡ï¼Œé¡ä¼¼ç™½åå–®çš„æ¦‚å¿µã€‚\nå¦‚æœæ²’æœ‰åšé€™å€‹æ­¥é©Ÿï¼Œå¯èƒ½æœƒé‡åˆ° Host key verification failed çš„éŒ¯èª¤ï¼ˆæˆ‘å°±é‡åˆ°äº† QQï¼‰ã€‚\næª”æ¡ˆæ¬Šé™ 644 è¡¨ç¤ºï¼š\næª”æ¡ˆæ“æœ‰è€…å¯ä»¥è®€å¯« å…¶ä»–äººåªèƒ½è®€ cat \u003e /volume1//git_pull_env/.ssh/known_hosts \u003c\u003c'EOF' github.com ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOMqqnkVzrm0SdG6UOoqKLsabgH5C9okWi0dh2l9GKJl github.com ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEmKSENjQEezOmxkZMy7opKgwFB9nkt5YRrYMjNuG5N87uRgg6CLrbo5wAdT/y6v0mKV0U2w0WZ2YB/++Tpockg= github.com ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCj7ndNxQowgcQnjshcLrqPEiiphnt+VTTvDP6mHBL9j1aNUkY4Ue1gvwnGLVlOhGeYrnZaMgRK6+PKCUXaDbC7qtbW8gIkhL7aGCsOr/C56SJMy/BCZfxd1nWzAOxSDPgVsmerOBYfNqltV9/hWCqBywINIR+5dIg6JTJ72pcEpEjcYgXkE2YEFXV1JHnsKgbLWNlhScqb2UmyRkQyytRLtL+38TGxkxCflmO+5Z8CSSNY7GidjMIZ7Q4zMjA2n1nGrlTDkzwDCsw+wqFPGQA179cnfGWOWRVruj16z6XyvxvjJwbz0wQZ75XK5tKSb7FNyeIEs4TT4jk+S4dhPeAUC5y+bDYirYgM4GC7uEnztnZyaVWQ7B381AK4Qdrwt51ZqExKbQpTUNn+EjqoTwvqNj4kqx5QUCI0ThS/YkOxJCXmPUWZbhjpCg56i+2aB6CmK2JGhn57K5mj0MNdBXA4/WnwH6XoPWJzK5Nyu2zB3nAZp+S5hpQs+p1vN1/wsjk= EOF chmod 644 /volume1//git_pull_env/.ssh/known_hosts ğŸŒ æ­¥é©Ÿ 4ï¼šå°‡å…¬é‘°åŠ å…¥ GitHub Deploy Key åŸ·è¡ŒæŸ¥çœ‹å…¬é‘°æŒ‡ä»¤ï¼Œè¤‡è£½å›å‚³çš„æ–‡å­—ï¼ˆä½ çš„å…¬é‘°ï¼‰ï¼š\ncat /volume1//git_pull_env/.ssh/id_ed25519.pub è¤‡è£½æ–‡å­—ä¸¦è²¼ä¸Šåˆ°ï¼š\nâ†’ GitHub Repository â†’ Settings â†’ Deploy Keys â†’ Add Key â†’ å…è¨± Read-only å³å¯\nğŸ§ª æ­¥é©Ÿ 5ï¼šæº–å‚™å°ˆæ¡ˆç›®éŒ„ é¸å®šä½ æ”¾ç½®å°ˆæ¡ˆçš„è·¯å¾‘ï¼Œæˆ‘å€‘å…ˆè¨˜éŒ„èµ·ä¾†ï¼Œä¾‹å¦‚ï¼š\n/volume1/docker/ ğŸ³ æ­¥é©Ÿ 6ï¼šè£½ä½œ git-pull-in-docker.sh è…³æœ¬ï¼ˆç”¨ Docker åŸ·è¡Œï¼‰ ä½ å¯èƒ½æœƒæƒ³ï¼Œç‚ºä»€éº¼ä¸ç›´æ¥ä½¿ç”¨ git pull ä¾†æ›´æ–°å°ˆæ¡ˆï¼Ÿ\né€™æ˜¯å› ç‚º DSM é è¨­æ²’æœ‰å…§å»º Git CLIï¼Œè€Œå¥—ä»¶ä¸­å¿ƒè£¡çš„ Git Server å¥—ä»¶ä¹Ÿåªæ”¯æ´ Git è¨—ç®¡ï¼ˆhostingï¼‰åŠŸèƒ½ï¼Œä¸åŒ…å« git pull é€™é¡çš„å®¢æˆ¶ç«¯ï¼ˆclientï¼‰æŒ‡ä»¤ã€‚å› æ­¤ï¼Œè¦ç”¨åŸç”Ÿæ–¹å¼å®Œæˆæˆ‘å€‘çš„éœ€æ±‚å¹¾ä¹ä¸å¯èƒ½ã€‚\nåŠ ä¸Šé€™å°æ©Ÿå™¨æ˜¯å®¢æˆ¶çš„ï¼Œä¸èƒ½ä½¿ç”¨ CLI å®‰è£ Gitï¼Œä»¥å…ã€Œæ±¡æŸ“ç’°å¢ƒã€ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥è€ƒæ…®åˆ©ç”¨ Docker å»ºç«‹ä¸€å€‹å¯æ§ä¸”ç¨ç«‹çš„ç’°å¢ƒä¾†åŸ·è¡Œ Git æŒ‡ä»¤ã€‚\næˆ‘å€‘é¸æ“‡ alpine/git é€™å€‹æ˜ åƒæª”ï¼ˆimageï¼‰ï¼Œä¸¦å°‡å°ˆæ¡ˆç›®éŒ„æ›è¼‰åˆ° Docker å®¹å™¨ä¸­ï¼Œå°±èƒ½æ­£å¸¸ä½¿ç”¨ git pull æŒ‡ä»¤ä¾†æ›´æ–°å°ˆæ¡ˆäº†ã€‚\næœ¬æ–‡æ‰€ä½¿ç”¨çš„ Docker æ˜¯ Synology çš„ Docker å¥—ä»¶ï¼ˆContainer Managerï¼‰ï¼Œè‹¥ä½ åœ¨å…¶ä»–ç’°å¢ƒæ“ä½œï¼Œè«‹è‡ªè¡Œèª¿æ•´ã€‚\nåœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œä»¥ä¸‹çš„æŒ‡ä»¤ï¼Œå»ºç«‹ä¸€å€‹ git-pull-in-docker.sh è…³æœ¬ï¼Œé€™å€‹è…³æœ¬æœƒç”¨ Docker åŸ·è¡Œ git pull æŒ‡ä»¤ä¾†æ›´æ–°å°ˆæ¡ˆã€‚\ncat \u003e /volume1//git_pull_env/git-pull-in-docker.sh \u003c\u003c'EOF' #!/bin/bash set -euo pipefail echo \"==== ğŸ•’ $(date '+%F %T') git pull é–‹å§‹ ====\" REPO_DIR=\"/volume1/docker/\" SSH_PATH=\"/volume1//git_pull_env/.ssh\" GIT_SSH=\"ssh -i /root/.ssh/id_ed25519 -F /root/.ssh/config\" # ç¢ºèª .git æ˜¯å¦å­˜åœ¨ if [ ! -d \"$REPO_DIR/.git\" ]; then echo \"âŒ æ‰¾ä¸åˆ° .gitï¼Œé€™ä¸æ˜¯ä¸€å€‹ Git repo\" exit 1 fi # Docker åŸ·è¡Œ git pull docker run --rm \\ -v \"$REPO_DIR\":/repo \\ -v \"$SSH_PATH/id_ed25519\":/root/.ssh/id_ed25519:ro \\ -v \"$SSH_PATH/config\":/root/.ssh/config:ro \\ -v \"$SSH_PATH/known_hosts\":/root/.ssh/known_hosts:ro \\ -e GIT_SSH_COMMAND=\"$GIT_SSH\" \\ alpine/git \\ -C /repo pull origin main echo \"âœ… git pull å®Œæˆ\" EOF chmod +x /volume1//git_pull_env/git-pull-in-docker.sh ğŸ§ª æ­¥é©Ÿ 7ï¼šæ¸¬è©¦åŸ·è¡Œ åœ¨é‚„é–‹è‘—çš„çµ‚ç«¯æ©ŸåŸ·è¡Œï¼š\nsh /volume1//git_pull_env/git-pull-in-docker.sh ä½ æ‡‰è©²æœƒçœ‹åˆ°ä»¥ä¸‹åŸ·è¡Œçµæœï¼š\n==== 2025-07-15 21:00:00 git pull é–‹å§‹ ==== Already up to date. âœ… git pull å®Œæˆ ğŸ—“ï¸ æ­¥é©Ÿ 8ï¼šè¨­å®š DSM ä»»å‹™æ’ç¨‹å™¨ é€šå¸¸åœ¨ Linux Server ä¸Šï¼Œæˆ‘å€‘ç›´æ¥æ“ä½œ crontab ä¾†è¨­å®šå®šæ™‚ä»»å‹™ï¼Œä¸éåœ¨ DSM ä¸Šï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ã€Œä»»å‹™æ’ç¨‹å™¨ã€ä¾†è¨­å®šå®šæ™‚ä»»å‹™ï¼Œæœƒæ›´åŠ åœ°åŸç”Ÿï¼Œé¿å…æ¬Šé™æˆ–è¦†å¯«è¡çªç­‰éŒ¯èª¤ã€‚\nè¬ä¹‹éŸ³ï¼šæˆ‘ä¹Ÿå¾ˆæ€•åœ¨å¥—çš®çš„ç³»çµ±åº•å±¤æ”¹ä¸€æ”¹å°±çˆ†äº†ã€‚\nå‰å¾€ DSM â†’ æ§åˆ¶å° â†’ ä»»å‹™æ’ç¨‹å™¨ æ–°å¢ã€Œä½¿ç”¨è€…å®šç¾©çš„è…³æœ¬ã€ ä½¿ç”¨è€…é¸æ“‡ root æŒ‡ä»¤å¡«å…¥ï¼š chmod +x /volume1//git_pull_env/git-pull-in-docker.sh sh /volume1//git_pull_env/git-pull-in-docker.sh è¨­å®šç‚ºæ¯å¤© / æ¯å°æ™‚åŸ·è¡Œå³å¯ã€‚ ä¹‹æ‰€ä»¥é¸æ“‡ root ä½¿ç”¨è€…ï¼Œæ˜¯åªæœ‰æœ€é«˜æ¬Šé™çš„ä½¿ç”¨è€…å¯ä»¥å­˜å– Docker daemonï¼Œé€²è€Œæ“ä½œ Docker Image å’Œ Container å®¹å™¨ã€‚\nå¦‚æœä½ çš„å¸³è™Ÿæ“æœ‰æœ€é«˜æ¬Šé™ï¼Œåœ¨ä»‹é¢è¦æ±‚è¼¸å…¥ root å¯†ç¢¼æ™‚ï¼Œä½ å¯ä»¥è¼¸å…¥ç•¶ä¸‹ä½¿ç”¨è€…çš„å¯†ç¢¼ã€‚\né€éä»‹é¢åŸ·è¡Œä¸€æ¬¡å‰›å‰›æ–°å¢çš„ä»»å‹™å¾Œï¼Œå³å¯çœ‹åˆ°åŸ·è¡Œçš„ logï¼Œç¢ºèªæ˜¯å¦æˆåŠŸã€‚\nâœ… å°çµï¼šæˆæœç¸½è¦½ å…ƒä»¶ åŠŸèƒ½ id_ed25519 GitHub Deploy Keyï¼ˆç§é‘°ï¼‰ config SSH è¨­å®šï¼ŒæŒ‡å®šä½¿ç”¨ Deploy Key known_hosts é å…ˆä¿¡ä»» GitHub Host keyï¼Œé¿å…å¡äº’å‹• git-pull-in-docker.sh ç”¨ Docker + git image åŸ·è¡Œ git pull DSM ä»»å‹™æ’ç¨‹å™¨ å®šæ™‚åŸ·è¡Œè‡ªå‹•æ›´æ–°ï¼Œä»¥åŠä»¥ ğŸ“’ åƒè€ƒè³‡æ–™ Connecting to GitHub with SSH - GitHub Docs Git Server - Synology çŸ¥è­˜ä¸­å¿ƒ SSH Key Authentication on Synology - Reddit åœ¨ç¾¤æš‰ Synology NAS DSM7.0 ä¸Šå®‰è£å¥—ä»¶ç®¡ç†å™¨ é€™ç¯‡æ–‡ç« èˆ‡ç¨‹å¼ç¢¼ä½¿ç”¨ ChatGPT å’Œ Claude-4-sonnet by Cursor è¼”åŠ©æ’°å¯«ã€‚\n","wordCount":"582","inLanguage":"en","image":"https://blog.imych.one/synology-git-pull-with-docker-and-deploy-key/SCR-20250716-fkyr.png","datePublished":"2025-07-16T00:00:00+08:00","dateModified":"2025-07-16T00:00:00+08:00","author":{"@type":"Person","name":{"name":"æ²¹æˆ"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.imych.one/synology-git-pull-with-docker-and-deploy-key/"},"publisher":{"@type":"Organization","name":"YC Photography","logo":{"@type":"ImageObject","url":"https://imych.one/assets/youu.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.imych.one/ accesskey=h title="YC Photography (Alt + H)">YC Photography</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.imych.one/tags/now/ title=Now><span>Now</span></a></li><li><a href=https://blog.imych.one/invitation-code/ title=é‚€è«‹ç¢¼><span>é‚€è«‹ç¢¼</span></a></li><li><a href=https://blog.imych.one/categories/ title=åˆ†é¡><span>åˆ†é¡</span></a></li><li><a href=https://blog.imych.one/tags/ title=æ¨™ç±¤><span>æ¨™ç±¤</span></a></li><li><a href=https://blog.imych.one/about/ title=é—œæ–¼><span>é—œæ–¼</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">è¸©å‘ç´€éŒ„ï¼šåœ¨ç„¡ Git CLI çš„ Synology DSM ä¸Šå¯¦ä½œ Git Private Repository è‡ªå‹•æ›´æ–°</h1><div class=post-meta>æ²¹æˆ Â· 2025 å¹´ 07 æœˆ 16 æ—¥ ç™¼å¸ƒ</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#-%e5%89%8d%e7%bd%ae%e6%ba%96%e5%82%99%e5%bb%ba%e7%ab%8b%e8%b3%87%e6%96%99%e5%a4%be%e7%b5%90%e6%a7%8b aria-label="ğŸ§± å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™å¤¾çµæ§‹">ğŸ§± å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™å¤¾çµæ§‹</a></li><li><a href=#-%e6%ad%a5%e9%a9%9f-1%e7%94%a2%e7%94%9f-ssh-deploy-key aria-label="ğŸ” æ­¥é©Ÿ 1ï¼šç”¢ç”Ÿ SSH Deploy Key">ğŸ” æ­¥é©Ÿ 1ï¼šç”¢ç”Ÿ SSH Deploy Key</a></li><li><a href=#-%e6%ad%a5%e9%a9%9f-2%e8%a8%ad%e5%ae%9a-ssh-config aria-label="ğŸ“‹ æ­¥é©Ÿ 2ï¼šè¨­å®š SSH config">ğŸ“‹ æ­¥é©Ÿ 2ï¼šè¨­å®š SSH config</a></li><li><a href=#-%e6%ad%a5%e9%a9%9f-3%e6%89%8b%e5%8b%95%e5%a1%ab%e5%85%a5-github-known_hosts aria-label="ğŸ›¡ï¸ æ­¥é©Ÿ 3ï¼šæ‰‹å‹•å¡«å…¥ GitHub known_hosts">ğŸ›¡ï¸ æ­¥é©Ÿ 3ï¼šæ‰‹å‹•å¡«å…¥ GitHub known_hosts</a></li><li><a href=#-%e6%ad%a5%e9%a9%9f-4%e5%b0%87%e5%85%ac%e9%91%b0%e5%8a%a0%e5%85%a5-github-deploy-key aria-label="ğŸŒ æ­¥é©Ÿ 4ï¼šå°‡å…¬é‘°åŠ å…¥ GitHub Deploy Key">ğŸŒ æ­¥é©Ÿ 4ï¼šå°‡å…¬é‘°åŠ å…¥ GitHub Deploy Key</a></li><li><a href=#-%e6%ad%a5%e9%a9%9f-5%e6%ba%96%e5%82%99%e5%b0%88%e6%a1%88%e7%9b%ae%e9%8c%84 aria-label="ğŸ§ª æ­¥é©Ÿ 5ï¼šæº–å‚™å°ˆæ¡ˆç›®éŒ„">ğŸ§ª æ­¥é©Ÿ 5ï¼šæº–å‚™å°ˆæ¡ˆç›®éŒ„</a></li><li><a href=#-%e6%ad%a5%e9%a9%9f-6%e8%a3%bd%e4%bd%9c-git-pull-in-dockersh-%e8%85%b3%e6%9c%ac%e7%94%a8-docker-%e5%9f%b7%e8%a1%8c aria-label="ğŸ³ æ­¥é©Ÿ 6ï¼šè£½ä½œ git-pull-in-docker.sh è…³æœ¬ï¼ˆç”¨ Docker åŸ·è¡Œï¼‰">ğŸ³ æ­¥é©Ÿ 6ï¼šè£½ä½œ git-pull-in-docker.sh è…³æœ¬ï¼ˆç”¨ Docker åŸ·è¡Œï¼‰</a></li><li><a href=#-%e6%ad%a5%e9%a9%9f-7%e6%b8%ac%e8%a9%a6%e5%9f%b7%e8%a1%8c aria-label="ğŸ§ª æ­¥é©Ÿ 7ï¼šæ¸¬è©¦åŸ·è¡Œ">ğŸ§ª æ­¥é©Ÿ 7ï¼šæ¸¬è©¦åŸ·è¡Œ</a></li><li><a href=#-%e6%ad%a5%e9%a9%9f-8%e8%a8%ad%e5%ae%9a-dsm-%e4%bb%bb%e5%8b%99%e6%8e%92%e7%a8%8b%e5%99%a8 aria-label="ğŸ—“ï¸ æ­¥é©Ÿ 8ï¼šè¨­å®š DSM ä»»å‹™æ’ç¨‹å™¨">ğŸ—“ï¸ æ­¥é©Ÿ 8ï¼šè¨­å®š DSM ä»»å‹™æ’ç¨‹å™¨</a></li><li><a href=#-%e5%b0%8f%e7%b5%90%e6%88%90%e6%9e%9c%e7%b8%bd%e8%a6%bd aria-label="âœ… å°çµï¼šæˆæœç¸½è¦½">âœ… å°çµï¼šæˆæœç¸½è¦½</a></li><li><a href=#-%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99 aria-label="ğŸ“’ åƒè€ƒè³‡æ–™">ğŸ“’ åƒè€ƒè³‡æ–™</a></li></ul></div></details></div><div class=post-content><p>æœ‰äº›äººæƒ³åœ¨è‡ªå·±çš„ Synology NAS ä¸Šæ¶ç¶²ç«™ï¼Œä¸¦ä¸”è®“ç¨‹å¼ç¢¼èƒ½è‡ªå‹•ç‰ˆæœ¬æ›´æ–°ã€‚å¦‚æœåœ¨ç´” Linux ç’°å¢ƒè£¡æ“ä½œï¼Œé€™æ¨£çš„éœ€æ±‚ä¸ç®—å¤ªéº»ç…©ï¼Œé€šå¸¸å¯ä»¥æ­é… crontab + git ä¾†è‡ªå‹•æ›´æ–°ç¨‹å¼ç¢¼ï¼Œå°±ç®—æ˜¯ Private Repository ä¹Ÿä¸æ˜¯å¤ªå¤§çš„å•é¡Œã€‚</p><p>ä¸éå¦‚æœæƒ³è¦åœ¨ Synology DSM ï¼ˆä»¥ä¸‹ç¨± DSMï¼‰ä¸Šå¯¦ä½œï¼Œç”±æ–¼ DSM å’Œçµ‚ç«¯é è¨­æ²’æœ‰å…§å»º Git CLIï¼Œé™¤äº†å¥—ä»¶ä¸­å¿ƒä¸æ”¯æ´ï¼Œè‡ªè¡Œå®‰è£ä¹Ÿéœ€è¦æ“”å¿ƒæ±¡æŸ“ç’°å¢ƒæˆ–è¢«è¦†å¯«ã€‚é™¤äº†ç›´æ¥æŠŠ code æ‰‹å‹•æ”¾åˆ°å°ˆæ¡ˆç›®éŒ„è£¡ï¼Œæˆ‘å€‘è¦ä¾†ç”¨ä¸€äº›åœŸç‚®çš„æ–¹å¼ç¹éé€™äº›é™åˆ¶ã€‚</p><p>é€™ç¯‡å°‡ç¤ºç¯„ï¼š</p><ul><li>ä½¿ç”¨ GitHub Deploy Key é€²è¡Œæ¬Šé™é©—è­‰</li><li>ä½¿ç”¨ Docker container åŸ·è¡Œ <code>git pull</code></li><li>è‡ªå‹•æ›´æ–° repo è‡³æŒ‡å®šè³‡æ–™å¤¾</li><li>å¯æ•´åˆ DSM ä»»å‹™æ’ç¨‹å™¨å®šæ™‚åŸ·è¡Œ</li></ul><hr><h2 id=-å‰ç½®æº–å‚™å»ºç«‹è³‡æ–™å¤¾çµæ§‹>ğŸ§± å‰ç½®æº–å‚™ï¼šå»ºç«‹è³‡æ–™å¤¾çµæ§‹<a hidden class=anchor aria-hidden=true href=#-å‰ç½®æº–å‚™å»ºç«‹è³‡æ–™å¤¾çµæ§‹>#</a></h2><p>åœ¨ Synology ä¸Šå»ºç«‹ä»¥ä¸‹ç›®éŒ„çµæ§‹ï¼Œå°‡æœƒç”¨åˆ°çš„ SSH è¨­å®šæª”ã€è…³æœ¬ç­‰éƒ½æ”¾åœ¨é€™å€‹è³‡æ–™å¤¾è£¡ã€‚</p><p>è«‹æ­é… SSH é€£ç·šä¾†æ“ä½œåœ¨æ ¹ç›®éŒ„å»ºç«‹è³‡æ–™å¤¾ã€‚</p><blockquote><p>å¦‚æœ SSH é€£ç·šçš„åŠŸèƒ½é‚„æ²’å•Ÿç”¨ï¼Œè«‹å…ˆåˆ° Synology çš„æ§åˆ¶å° â†’ å®‰å…¨æ€§ â†’ é ç«¯å­˜å– â†’ å•Ÿç”¨é ç«¯å­˜å–ã€‚</p></blockquote><blockquote><p>volume1 æ˜¯æˆ‘é€™å° Synology ä¸Šçš„æ ¹ç›®éŒ„ï¼Œå¦‚æœä½ æœ‰å…¶ä»–é¸æ“‡ï¼Œä½ å¯ä»¥æ”¹æˆå…¶ä»–ç›®éŒ„ï¼Œä¾‹å¦‚ /volume2/ æˆ– /volume3/ã€‚</p></blockquote><pre tabindex=0><code>/volume1/                           # ä½ çš„ NAS æ ¹ç›®éŒ„ï¼Œæ­¤è™•ä»¥ volume1 ç‚ºä¾‹
â””â”€â”€ &lt;your_repo_name&gt;/               # ä½ æ”¾å°ˆæ¡ˆ code è³‡æ–™å¤¾çš„åç¨±
    â””â”€â”€ git_pull_env/               # Git è‡ªå‹•åŒ–åŸ·è¡Œç’°å¢ƒ
        â”œâ”€â”€ .ssh/                   # å­˜æ”¾ Deploy Key èˆ‡ ssh config
        â”œâ”€â”€ git-pull-in-docker.sh   # ç”¨ Docker åŸ·è¡Œ git pull çš„è…³æœ¬
        â””â”€â”€ known_hosts             # é è¨­å¡«å…¥ github.com host key
</code></pre><hr><h2 id=-æ­¥é©Ÿ-1ç”¢ç”Ÿ-ssh-deploy-key>ğŸ” æ­¥é©Ÿ 1ï¼šç”¢ç”Ÿ SSH Deploy Key<a hidden class=anchor aria-hidden=true href=#-æ­¥é©Ÿ-1ç”¢ç”Ÿ-ssh-deploy-key>#</a></h2><p>æˆ‘å€‘æ¡ç”¨ SSH Deploy Key çš„æ–¹å¼ä¾†éƒ¨ç½²ï¼Œç›¸è¼ƒæ–¼ä½¿ç”¨ URL æ­é… access tokenï¼Œé€™ç¨®æ–¹å¼æ›´ç‚ºå®‰å…¨ï¼Œèƒ½æœ‰æ•ˆé¿å… token åœ¨é€£ç·šéç¨‹ä¸­è¢«ç«Šè½æˆ–ç›œç”¨ã€‚</p><hr><table><thead><tr><th style=text-align:left>é€£ç·šæ–¹å¼</th><th style=text-align:left>å„ªé»</th><th style=text-align:left>ç¼ºé»</th><th style=text-align:left>é©ç”¨æƒ…å¢ƒ</th></tr></thead><tbody><tr><td style=text-align:left><strong>HTTPS ï¼ˆæ­é… Personal Access Tokenï¼‰</strong></td><td style=text-align:left><strong>æ˜“æ–¼è¨­å®š</strong>ï¼šåªéœ€åœ¨ URL ä¸­åµŒå…¥ access token å³å¯ã€‚</td><td style=text-align:left><strong>å®‰å…¨æ€§è¼ƒä½</strong>ï¼štoken åœ¨é€£ç·šéç¨‹ä¸­å¯èƒ½è¢«æƒ¡æ„ç¨‹å¼ç¢¼æˆ–ç¶²è·¯ç›£è½ç«Šå–ï¼Œå­˜åœ¨å¤–æ´©é¢¨éšªã€‚</td><td style=text-align:left><strong>å€‹äººå°ˆæ¡ˆ</strong>æˆ–<strong>éæ©Ÿå¯†æ€§</strong>çš„éƒ¨ç½²ç’°å¢ƒã€‚</td></tr><tr><td style=text-align:left><strong>SSH ï¼ˆæ­é… Deploy Keyï¼‰</strong></td><td style=text-align:left><strong>å®‰å…¨æ€§æ›´é«˜</strong>ï¼šæ¡ç”¨åŠ å¯†é€šè¨Šå”å®šï¼Œé€£ç·šéç¨‹ä¸­ä¸æœƒå‚³è¼¸ä»»ä½•æ†‘è­‰ï¼Œæœ‰æ•ˆé¿å… token è¢«ç«Šè½æˆ–ç›œç”¨ã€‚</td><td style=text-align:left><strong>è¨­å®šæ­¥é©Ÿè¼ƒç‚ºç¹ç‘£</strong>ï¼šéœ€è¦ç”¢ç”Ÿ SSH é‡‘é‘°å°ä¸¦åœ¨ GitHub å°ˆæ¡ˆä¸­æ–°å¢ Deploy Keyã€‚</td><td style=text-align:left><strong>æ­£å¼éƒ¨ç½²ç’°å¢ƒ</strong>ã€<strong>ä¼ºæœå™¨</strong>æˆ–<strong>éœ€è¦åš´è¬¹å®‰å…¨æ€§</strong>çš„è‡ªå‹•åŒ–éƒ¨ç½²æµç¨‹ã€‚</td></tr></tbody></table><p>ä½¿ç”¨ SSH é€£ç·šè‡³ä½ çš„ NASï¼Œåœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p /volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh
</span></span><span style=display:flex><span>ssh-keygen -t ed25519 -f /volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh/id_ed25519 -C <span style=color:#e6db74>&#34;&lt;deploy&gt;@&lt;hostname&gt;&#34;</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> /volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh/id_ed25519
</span></span></code></pre></div><p>ç¬¬äºŒæ¢æŒ‡ä»¤æœ«ç«¯çš„ <code>&lt;deploy></code> æ˜¯ç‚ºäº†æ–¹ä¾¿è¾¨è­˜ï¼Œå¯ä»¥æ”¹æˆå…¶ä»–åç¨±ï¼›<code>&lt;hostname></code> å‰‡æ˜¯ä½ çš„ NAS ä¸»æ©Ÿåç¨±ï¼Œä¸€æ¨£å¯ä»¥æ”¹æˆå…¶ä»–åç¨±ï¼Œä¾‹å¦‚ <code>deploy@yc_nas</code>ã€‚</p><hr><h2 id=-æ­¥é©Ÿ-2è¨­å®š-ssh-config>ğŸ“‹ æ­¥é©Ÿ 2ï¼šè¨­å®š SSH config<a hidden class=anchor aria-hidden=true href=#-æ­¥é©Ÿ-2è¨­å®š-ssh-config>#</a></h2><p>SSH config çš„è¨­å®šï¼ŒæŒ‡å®šä½¿ç”¨æˆ‘å€‘å‰›å‰›ç”¢ç”Ÿçš„ Deploy Keyï¼Œä¸»è¦æ˜¯ç‚ºäº†è®“ GitHub èªå¾—é€™æ”¯æœ‰æ¬Šé™çš„èº«ä»½ï¼Œé€²è€Œå­˜å–å°ˆæ¡ˆã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt; /volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh/config <span style=color:#e6db74>&lt;&lt;&#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Host github.com
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    HostName github.com
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    User git
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    IdentityFile /root/.ssh/id_ed25519
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    IdentitiesOnly yes
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> /volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh/config
</span></span></code></pre></div><hr><h2 id=-æ­¥é©Ÿ-3æ‰‹å‹•å¡«å…¥-github-known_hosts>ğŸ›¡ï¸ æ­¥é©Ÿ 3ï¼šæ‰‹å‹•å¡«å…¥ GitHub <code>known_hosts</code><a hidden class=anchor aria-hidden=true href=#-æ­¥é©Ÿ-3æ‰‹å‹•å¡«å…¥-github-known_hosts>#</a></h2><p>ç•¶æˆ‘å€‘ç”¨ SSH å»é€£ GitHub æ‹‰åŸå§‹ç¢¼æ™‚ï¼Œç³»çµ±æœƒå…ˆæª¢æŸ¥ä¸»æ©ŸæŒ‡ç´‹ï¼ˆhost fingerprintï¼‰ä¾†ç¢ºä¿ã€Œä½ é€£çš„çœŸçš„æ˜¯ GitHubï¼Œè€Œä¸æ˜¯æŸå€‹å‡å†’çš„ä¸­é–“äººã€ã€‚é€™å…¶å¯¦æ˜¯é¿å…
<a href=https://zh.wikipedia.org/zh-tw/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB target=_blank rel="nofollow noopener noreferrer"><span>ä¸­é–“äººæ”»æ“Šï¼ˆMITMï¼‰
</span></a>çš„ä¸€ç¨®æ©Ÿåˆ¶ã€‚</p><p>å¹³å¸¸å¦‚æœæœ‰å®‰è£ <code>ssh-keyscan</code> æŒ‡ä»¤çš„è©±ï¼Œæˆ‘å€‘å¯ä»¥ç”¨å®ƒè‡ªå‹•æŠŠ GitHub çš„ä¸»æ©Ÿé‡‘é‘°åŠ é€² <code>known_hosts</code>ã€‚ä½†åœ¨ DSM ä¸Šååæ²’æœ‰é€™å€‹å·¥å…·ï¼Œå› æ­¤æˆ‘å€‘å¾—ã€Œæ‰‹å‹•ã€æŠŠ GitHub çš„ä¸»æ©ŸæŒ‡ç´‹åŠ é€²å»ã€‚</p><p>å¯ä»¥åˆ° GitHub å®˜æ–¹æŸ¥è©¢ä»–å€‘ç›®å‰çš„
<a href=https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/githubs-ssh-key-fingerprints target=_blank rel="nofollow noopener noreferrer"><span>SSH ä¸»æ©ŸæŒ‡ç´‹
</span></a>ï¼Œç„¶å¾Œæ‰‹å‹•æŠŠå…§å®¹å¯«é€² <code>~/.ssh/known_hosts</code> è£¡ï¼Œé¡ä¼¼ç™½åå–®çš„æ¦‚å¿µã€‚</p><blockquote><p>å¦‚æœæ²’æœ‰åšé€™å€‹æ­¥é©Ÿï¼Œå¯èƒ½æœƒé‡åˆ° <code>Host key verification failed</code> çš„éŒ¯èª¤ï¼ˆæˆ‘å°±é‡åˆ°äº† QQï¼‰ã€‚</p></blockquote><blockquote><p>æª”æ¡ˆæ¬Šé™ 644 è¡¨ç¤ºï¼š</p><ul><li>æª”æ¡ˆæ“æœ‰è€…å¯ä»¥è®€å¯«</li><li>å…¶ä»–äººåªèƒ½è®€</li></ul></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt; /volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh/known_hosts <span style=color:#e6db74>&lt;&lt;&#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>github.com ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOMqqnkVzrm0SdG6UOoqKLsabgH5C9okWi0dh2l9GKJl
</span></span></span><span style=display:flex><span><span style=color:#e6db74>github.com ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEmKSENjQEezOmxkZMy7opKgwFB9nkt5YRrYMjNuG5N87uRgg6CLrbo5wAdT/y6v0mKV0U2w0WZ2YB/++Tpockg=
</span></span></span><span style=display:flex><span><span style=color:#e6db74>github.com ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCj7ndNxQowgcQnjshcLrqPEiiphnt+VTTvDP6mHBL9j1aNUkY4Ue1gvwnGLVlOhGeYrnZaMgRK6+PKCUXaDbC7qtbW8gIkhL7aGCsOr/C56SJMy/BCZfxd1nWzAOxSDPgVsmerOBYfNqltV9/hWCqBywINIR+5dIg6JTJ72pcEpEjcYgXkE2YEFXV1JHnsKgbLWNlhScqb2UmyRkQyytRLtL+38TGxkxCflmO+5Z8CSSNY7GidjMIZ7Q4zMjA2n1nGrlTDkzwDCsw+wqFPGQA179cnfGWOWRVruj16z6XyvxvjJwbz0wQZ75XK5tKSb7FNyeIEs4TT4jk+S4dhPeAUC5y+bDYirYgM4GC7uEnztnZyaVWQ7B381AK4Qdrwt51ZqExKbQpTUNn+EjqoTwvqNj4kqx5QUCI0ThS/YkOxJCXmPUWZbhjpCg56i+2aB6CmK2JGhn57K5mj0MNdBXA4/WnwH6XoPWJzK5Nyu2zB3nAZp+S5hpQs+p1vN1/wsjk=
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>644</span> /volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh/known_hosts
</span></span></code></pre></div><hr><h2 id=-æ­¥é©Ÿ-4å°‡å…¬é‘°åŠ å…¥-github-deploy-key>ğŸŒ æ­¥é©Ÿ 4ï¼šå°‡å…¬é‘°åŠ å…¥ GitHub Deploy Key<a hidden class=anchor aria-hidden=true href=#-æ­¥é©Ÿ-4å°‡å…¬é‘°åŠ å…¥-github-deploy-key>#</a></h2><ol><li><p>åŸ·è¡ŒæŸ¥çœ‹å…¬é‘°æŒ‡ä»¤ï¼Œè¤‡è£½å›å‚³çš„æ–‡å­—ï¼ˆä½ çš„å…¬é‘°ï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat /volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh/id_ed25519.pub
</span></span></code></pre></div></li><li><p>è¤‡è£½æ–‡å­—ä¸¦è²¼ä¸Šåˆ°ï¼š</p><p>â†’ GitHub Repository â†’ Settings â†’ Deploy Keys â†’ Add Key
â†’ å…è¨± <strong>Read-only</strong> å³å¯</p></li></ol><p><img alt="GitHub Deploy Key" loading=lazy src=/synology-git-pull-with-docker-and-deploy-key/SCR-20250716-eufg.png></p><hr><h2 id=-æ­¥é©Ÿ-5æº–å‚™å°ˆæ¡ˆç›®éŒ„>ğŸ§ª æ­¥é©Ÿ 5ï¼šæº–å‚™å°ˆæ¡ˆç›®éŒ„<a hidden class=anchor aria-hidden=true href=#-æ­¥é©Ÿ-5æº–å‚™å°ˆæ¡ˆç›®éŒ„>#</a></h2><p>é¸å®šä½ æ”¾ç½®å°ˆæ¡ˆçš„è·¯å¾‘ï¼Œæˆ‘å€‘å…ˆè¨˜éŒ„èµ·ä¾†ï¼Œä¾‹å¦‚ï¼š</p><pre tabindex=0><code>/volume1/docker/&lt;your_repo_name&gt;
</code></pre><hr><h2 id=-æ­¥é©Ÿ-6è£½ä½œ-git-pull-in-dockersh-è…³æœ¬ç”¨-docker-åŸ·è¡Œ>ğŸ³ æ­¥é©Ÿ 6ï¼šè£½ä½œ <code>git-pull-in-docker.sh</code> è…³æœ¬ï¼ˆç”¨ Docker åŸ·è¡Œï¼‰<a hidden class=anchor aria-hidden=true href=#-æ­¥é©Ÿ-6è£½ä½œ-git-pull-in-dockersh-è…³æœ¬ç”¨-docker-åŸ·è¡Œ>#</a></h2><p>ä½ å¯èƒ½æœƒæƒ³ï¼Œç‚ºä»€éº¼ä¸ç›´æ¥ä½¿ç”¨ <code>git pull</code> ä¾†æ›´æ–°å°ˆæ¡ˆï¼Ÿ</p><p>é€™æ˜¯å› ç‚º DSM é è¨­æ²’æœ‰å…§å»º Git CLIï¼Œè€Œå¥—ä»¶ä¸­å¿ƒè£¡çš„ Git Server å¥—ä»¶ä¹Ÿåªæ”¯æ´ Git è¨—ç®¡ï¼ˆhostingï¼‰åŠŸèƒ½ï¼Œä¸åŒ…å« <code>git pull</code> é€™é¡çš„å®¢æˆ¶ç«¯ï¼ˆclientï¼‰æŒ‡ä»¤ã€‚å› æ­¤ï¼Œè¦ç”¨åŸç”Ÿæ–¹å¼å®Œæˆæˆ‘å€‘çš„éœ€æ±‚å¹¾ä¹ä¸å¯èƒ½ã€‚</p><p>åŠ ä¸Šé€™å°æ©Ÿå™¨æ˜¯å®¢æˆ¶çš„ï¼Œä¸èƒ½ä½¿ç”¨ CLI å®‰è£ Gitï¼Œä»¥å…ã€Œæ±¡æŸ“ç’°å¢ƒã€ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥è€ƒæ…®åˆ©ç”¨ Docker å»ºç«‹ä¸€å€‹å¯æ§ä¸”ç¨ç«‹çš„ç’°å¢ƒä¾†åŸ·è¡Œ Git æŒ‡ä»¤ã€‚</p><p><strong>æˆ‘å€‘é¸æ“‡ <code>alpine/git</code> é€™å€‹æ˜ åƒæª”ï¼ˆimageï¼‰ï¼Œä¸¦å°‡å°ˆæ¡ˆç›®éŒ„æ›è¼‰åˆ° Docker å®¹å™¨ä¸­ï¼Œå°±èƒ½æ­£å¸¸ä½¿ç”¨ <code>git pull</code> æŒ‡ä»¤ä¾†æ›´æ–°å°ˆæ¡ˆäº†ã€‚</strong></p><blockquote><p>æœ¬æ–‡æ‰€ä½¿ç”¨çš„ Docker æ˜¯ Synology çš„ Docker å¥—ä»¶ï¼ˆContainer Managerï¼‰ï¼Œè‹¥ä½ åœ¨å…¶ä»–ç’°å¢ƒæ“ä½œï¼Œè«‹è‡ªè¡Œèª¿æ•´ã€‚</p></blockquote><p>åœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œä»¥ä¸‹çš„æŒ‡ä»¤ï¼Œå»ºç«‹ä¸€å€‹ <code>git-pull-in-docker.sh</code> è…³æœ¬ï¼Œé€™å€‹è…³æœ¬æœƒç”¨ Docker åŸ·è¡Œ <code>git pull</code> æŒ‡ä»¤ä¾†æ›´æ–°å°ˆæ¡ˆã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat &gt; /volume1/&lt;your_repo_name&gt;/git_pull_env/git-pull-in-docker.sh <span style=color:#e6db74>&lt;&lt;&#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set -euo pipefail
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;==== ğŸ•’ $(date &#39;+%F %T&#39;) git pull é–‹å§‹ ====&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>REPO_DIR=&#34;/volume1/docker/&lt;your_repo_name&gt;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>SSH_PATH=&#34;/volume1/&lt;your_repo_name&gt;/git_pull_env/.ssh&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>GIT_SSH=&#34;ssh -i /root/.ssh/id_ed25519 -F /root/.ssh/config&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># ç¢ºèª .git æ˜¯å¦å­˜åœ¨
</span></span></span><span style=display:flex><span><span style=color:#e6db74>if [ ! -d &#34;$REPO_DIR/.git&#34; ]; then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  echo &#34;âŒ æ‰¾ä¸åˆ° .gitï¼Œé€™ä¸æ˜¯ä¸€å€‹ Git repo&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  exit 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># Docker åŸ·è¡Œ git pull
</span></span></span><span style=display:flex><span><span style=color:#e6db74>docker run --rm \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  -v &#34;$REPO_DIR&#34;:/repo \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  -v &#34;$SSH_PATH/id_ed25519&#34;:/root/.ssh/id_ed25519:ro \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  -v &#34;$SSH_PATH/config&#34;:/root/.ssh/config:ro \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  -v &#34;$SSH_PATH/known_hosts&#34;:/root/.ssh/known_hosts:ro \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  -e GIT_SSH_COMMAND=&#34;$GIT_SSH&#34; \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  alpine/git \
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  -C /repo pull origin main
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>echo &#34;âœ… git pull å®Œæˆ&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span><span style=display:flex><span>chmod +x /volume1/&lt;your_repo_name&gt;/git_pull_env/git-pull-in-docker.sh
</span></span></code></pre></div><hr><h2 id=-æ­¥é©Ÿ-7æ¸¬è©¦åŸ·è¡Œ>ğŸ§ª æ­¥é©Ÿ 7ï¼šæ¸¬è©¦åŸ·è¡Œ<a hidden class=anchor aria-hidden=true href=#-æ­¥é©Ÿ-7æ¸¬è©¦åŸ·è¡Œ>#</a></h2><p>åœ¨é‚„é–‹è‘—çš„çµ‚ç«¯æ©ŸåŸ·è¡Œï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sh /volume1/&lt;your_repo_name&gt;/git_pull_env/git-pull-in-docker.sh
</span></span></code></pre></div><p>ä½ æ‡‰è©²æœƒçœ‹åˆ°ä»¥ä¸‹åŸ·è¡Œçµæœï¼š</p><pre tabindex=0><code>==== 2025-07-15 21:00:00 git pull é–‹å§‹ ====
Already up to date.
âœ… git pull å®Œæˆ
</code></pre><hr><h2 id=-æ­¥é©Ÿ-8è¨­å®š-dsm-ä»»å‹™æ’ç¨‹å™¨>ğŸ—“ï¸ æ­¥é©Ÿ 8ï¼šè¨­å®š DSM ä»»å‹™æ’ç¨‹å™¨<a hidden class=anchor aria-hidden=true href=#-æ­¥é©Ÿ-8è¨­å®š-dsm-ä»»å‹™æ’ç¨‹å™¨>#</a></h2><p>é€šå¸¸åœ¨ Linux Server ä¸Šï¼Œæˆ‘å€‘ç›´æ¥æ“ä½œ <code>crontab</code> ä¾†è¨­å®šå®šæ™‚ä»»å‹™ï¼Œä¸éåœ¨ DSM ä¸Šï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ã€Œä»»å‹™æ’ç¨‹å™¨ã€ä¾†è¨­å®šå®šæ™‚ä»»å‹™ï¼Œæœƒæ›´åŠ åœ°åŸç”Ÿï¼Œé¿å…æ¬Šé™æˆ–è¦†å¯«è¡çªç­‰éŒ¯èª¤ã€‚</p><p><del>è¬ä¹‹éŸ³ï¼šæˆ‘ä¹Ÿå¾ˆæ€•åœ¨å¥—çš®çš„ç³»çµ±åº•å±¤æ”¹ä¸€æ”¹å°±çˆ†äº†ã€‚</del></p><ul><li>å‰å¾€ DSM â†’ <strong>æ§åˆ¶å° â†’ ä»»å‹™æ’ç¨‹å™¨</strong></li><li>æ–°å¢ã€Œä½¿ç”¨è€…å®šç¾©çš„è…³æœ¬ã€</li><li>ä½¿ç”¨è€…é¸æ“‡ <code>root</code></li><li>æŒ‡ä»¤å¡«å…¥ï¼š</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod +x /volume1/&lt;your_repo_name&gt;/git_pull_env/git-pull-in-docker.sh
</span></span><span style=display:flex><span>sh /volume1/&lt;your_repo_name&gt;/git_pull_env/git-pull-in-docker.sh
</span></span></code></pre></div><ul><li>è¨­å®šç‚ºæ¯å¤© / æ¯å°æ™‚åŸ·è¡Œå³å¯ã€‚</li></ul><p>ä¹‹æ‰€ä»¥é¸æ“‡ <code>root</code> ä½¿ç”¨è€…ï¼Œæ˜¯åªæœ‰æœ€é«˜æ¬Šé™çš„ä½¿ç”¨è€…å¯ä»¥å­˜å– Docker daemonï¼Œé€²è€Œæ“ä½œ Docker Image å’Œ Container å®¹å™¨ã€‚</p><blockquote><p>å¦‚æœä½ çš„å¸³è™Ÿæ“æœ‰æœ€é«˜æ¬Šé™ï¼Œåœ¨ä»‹é¢è¦æ±‚è¼¸å…¥ root å¯†ç¢¼æ™‚ï¼Œä½ å¯ä»¥è¼¸å…¥ç•¶ä¸‹ä½¿ç”¨è€…çš„å¯†ç¢¼ã€‚</p></blockquote><p><img alt="DSM ä»»å‹™æ’ç¨‹å™¨ è¨­å®šåŸ·è¡ŒæŒ‡ä»¤" loading=lazy src=/synology-git-pull-with-docker-and-deploy-key/SCR-20250716-fkyr.png></p><p>é€éä»‹é¢åŸ·è¡Œä¸€æ¬¡å‰›å‰›æ–°å¢çš„ä»»å‹™å¾Œï¼Œå³å¯çœ‹åˆ°åŸ·è¡Œçš„ logï¼Œç¢ºèªæ˜¯å¦æˆåŠŸã€‚</p><p><img alt="DSM ä»»å‹™æ’ç¨‹å™¨ ç¢ºèªæŒ‡ä»¤åŸ·è¡ŒæˆåŠŸèˆ‡å¦" loading=lazy src=/synology-git-pull-with-docker-and-deploy-key/SCR-20250716-flks.png></p><hr><h2 id=-å°çµæˆæœç¸½è¦½>âœ… å°çµï¼šæˆæœç¸½è¦½<a hidden class=anchor aria-hidden=true href=#-å°çµæˆæœç¸½è¦½>#</a></h2><table><thead><tr><th>å…ƒä»¶</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>id_ed25519</code></td><td>GitHub Deploy Keyï¼ˆç§é‘°ï¼‰</td></tr><tr><td><code>config</code></td><td>SSH è¨­å®šï¼ŒæŒ‡å®šä½¿ç”¨ Deploy Key</td></tr><tr><td><code>known_hosts</code></td><td>é å…ˆä¿¡ä»» GitHub Host keyï¼Œé¿å…å¡äº’å‹•</td></tr><tr><td><code>git-pull-in-docker.sh</code></td><td>ç”¨ Docker + git image åŸ·è¡Œ <code>git pull</code></td></tr><tr><td><code>DSM ä»»å‹™æ’ç¨‹å™¨</code></td><td>å®šæ™‚åŸ·è¡Œè‡ªå‹•æ›´æ–°ï¼Œä»¥åŠä»¥</td></tr></tbody></table><hr><h2 id=-åƒè€ƒè³‡æ–™>ğŸ“’ åƒè€ƒè³‡æ–™<a hidden class=anchor aria-hidden=true href=#-åƒè€ƒè³‡æ–™>#</a></h2><ul><li><a href=https://docs.github.com/en/authentication/connecting-to-github-with-ssh target=_blank rel="nofollow noopener noreferrer"><span>Connecting to GitHub with SSH - GitHub Docs</span></a></li><li><a href="https://kb.synology.com/zh-hk/DSM/help/Git/git?version=7" target=_blank rel="nofollow noopener noreferrer"><span>Git Server - Synology çŸ¥è­˜ä¸­å¿ƒ</span></a></li><li><a href=https://www.reddit.com/r/synology/comments/12drqpz/ssh_key_authentication_on_synology/ target=_blank rel="nofollow noopener noreferrer"><span>SSH Key Authentication on Synology - Reddit</span></a></li><li><a href=https://natlee.github.io/Blog/posts/53cbcaf3/ target=_blank rel="nofollow noopener noreferrer"><span>åœ¨ç¾¤æš‰ Synology NAS DSM7.0 ä¸Šå®‰è£å¥—ä»¶ç®¡ç†å™¨</span></a></li></ul><p>é€™ç¯‡æ–‡ç« èˆ‡ç¨‹å¼ç¢¼ä½¿ç”¨ ChatGPT å’Œ Claude-4-sonnet by Cursor è¼”åŠ©æ’°å¯«ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.imych.one/tags/synology/>Synology</a></li><li><a href=https://blog.imych.one/tags/git/>Git</a></li><li><a href=https://blog.imych.one/tags/docker/>Docker</a></li><li><a href=https://blog.imych.one/tags/github/>GitHub</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://blog.imych.one/>YC Photography</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>